fragment PublicUser on User {
  displayName
  picture
  username
}

fragment FlickParticipant on User {
  ...PublicUser
  email
  sub
}

fragment User on MeOutput {
  createdAt
  displayName
  email
  onboarded
  picture
  provider
  sub
  username
  updatedAt
}

query GetUser {
  Me {
    ...User
  }
}

query GetFilteredUsers($_ilike: String!) {
  User(
    where: {
      _or: [
        { displayName: { _ilike: $_ilike } }
        { email: { _ilike: $_ilike } }
        { username: { _ilike: $_ilike } }
      ]
    }
  ) {
    ...FlickParticipant
  }
}

query IsUsernameAvailable($username: String!) {
  UsernameAvailability(username: $username) {
    message
    suggestion
    valid
  }
}

mutation UpdateOnboardingUser(
  $sub: String!
  $displayName: String!
  $username: String!
) {
  update_User_by_pk(
    pk_columns: { sub: $sub }
    _set: { displayName: $displayName, username: $username }
  ) {
    updatedAt
  }
}

mutation SetOnboarding {
  Onboarded {
    success
  }
}

mutation UpdateProfile($displayName: String!, $userId: String!) {
  update_User(
    _set: { displayName: $displayName }
    where: { sub: { _eq: $userId } }
  ) {
    affected_rows
  }
}

fragment ArtifactDetails on Artifact {
  id
  displayName
  objectLink
}

query UserArtifact {
  Artifact {
    ...ArtifactDetails
  }
}
